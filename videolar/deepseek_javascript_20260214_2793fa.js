{
  "parameters": {
    "jsCode": "// ğŸ“¦ GitHub Dosya Silme - .gitkeep hariÃ§ tÃ¼m videolarÄ± temizle\n\nconst GITHUB_TOKEN = 'YOUR_GITHUB_TOKEN_HERE'; // âš ï¸ Buraya kendi token'Ä±nÄ±zÄ± yazÄ±n\nconst REPO_OWNER = 'viskiey';\nconst REPO_NAME = 'masal-videolari';\nconst FOLDER_PATH = 'videos';\n\nasync function deleteAllFilesExceptGitkeep() {\n  try {\n    console.log('ğŸ” GitHub videos klasÃ¶rÃ¼ taranÄ±yor...');\n    console.log(`   ğŸ“‚ Kontrol edilen: ${REPO_OWNER}/${REPO_NAME}/${FOLDER_PATH}`);\n    \n    // 1. KlasÃ¶rdeki tÃ¼m dosyalarÄ± listele\n    const listResponse = await fetch(\n      `https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/contents/${FOLDER_PATH}`,\n      {\n        headers: {\n          'Authorization': `token ${GITHUB_TOKEN}`,\n          'Accept': 'application/vnd.github.v3+json'\n        }\n      }\n    );\n\n    if (!listResponse.ok) {\n      if (listResponse.status === 404) {\n        console.log('ğŸ“‚ KlasÃ¶r bulunamadÄ±!');\n        return { deleted: 0, message: 'KlasÃ¶r bulunamadÄ±' };\n      }\n      throw new Error(`GitHub API hatasÄ±: ${listResponse.status}`);\n    }\n\n    const files = await listResponse.json();\n    \n    // Sadece dosyalarÄ± filtrele ve .gitkeep'i KORU!\n    const filesToDelete = files.filter(item => \n      item.type === 'file' && item.name !== '.gitkeep'\n    );\n    \n    const gitkeepExists = files.some(item => item.name === '.gitkeep');\n    \n    console.log(`ğŸ“Š Durum:`);\n    console.log(`   ğŸ“„ Toplam dosya: ${files.length}`);\n    console.log(`   ğŸ›¡ï¸ .gitkeep var mÄ±: ${gitkeepExists ? 'Evet (KORUNACAK)' : 'HayÄ±r'}`);\n    console.log(`   ğŸ—‘ï¸ Silinecek dosya: ${filesToDelete.length}`);\n    \n    if (filesToDelete.length === 0) {\n      console.log('âœ¨ Silinecek dosya yok, klasÃ¶r zaten temiz!');\n      return { \n        deleted: 0, \n        message: 'Zaten temiz',\n        gitkeep_protected: gitkeepExists\n      };\n    }\n\n    // 2. Silinecek dosyalarÄ± listele\n    console.log('\\nğŸ“‹ Silinecek dosyalar:');\n    filesToDelete.forEach((file, index) => {\n      console.log(`   ${index + 1}. ${file.name}`);\n    });\n\n    // 3. Her dosya iÃ§in silme iÅŸlemi\n    const deleteResults = [];\n    \n    for (const file of filesToDelete) {\n      console.log(`\\nğŸ—‘ï¸ Siliniyor: ${file.name}`);\n      \n      try {\n        // DosyayÄ± sil\n        const deleteResponse = await fetch(\n          `https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/contents/${FOLDER_PATH}/${file.name}`,\n          {\n            method: 'DELETE',\n            headers: {\n              'Authorization': `token ${GITHUB_TOKEN}`,\n              'Accept': 'application/vnd.github.v3+json',\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({\n              message: `ğŸ—‘ï¸ Video silindi: ${file.name}`,\n              sha: file.sha,\n              committer: {\n                name: 'n8n Automation',\n                email: 'n8n@automation.local'\n              }\n            })\n          }\n        );\n        \n        if (deleteResponse.ok) {\n          console.log(`   âœ… BaÅŸarÄ±yla silindi`);\n          deleteResults.push({ name: file.name, success: true });\n        } else {\n          const error = await deleteResponse.text();\n          console.log(`   âŒ Silinemedi: ${error}`);\n          deleteResults.push({ name: file.name, success: false, error });\n        }\n        \n      } catch (fileError) {\n        console.log(`   âŒ Hata: ${fileError.message}`);\n        deleteResults.push({ name: file.name, success: false, error: fileError.message });\n      }\n      \n      // GitHub rate limit'e takÄ±lmamak iÃ§in kÄ±sa bekleme\n      await new Promise(resolve => setTimeout(resolve, 500));\n    }\n    \n    // 4. Son durumu kontrol et\n    const successCount = deleteResults.filter(r => r.success).length;\n    const failCount = deleteResults.filter(r => !r.success).length;\n    \n    console.log('\\n=================================');\n    console.log('ğŸ“Š SÄ°LME Ä°ÅLEMÄ° RAPORU:');\n    console.log('=================================');\n    console.log(`âœ… BaÅŸarÄ±yla silinen: ${successCount} dosya`);\n    console.log(`âŒ Silinemeyen: ${failCount} dosya`);\n    console.log(`ğŸ›¡ï¸ Korunan: .gitkeep dosyasÄ±`);\n    console.log('=================================');\n    \n    if (failCount > 0) {\n      console.log('\\nâŒ Silinemeyen dosyalar:');\n      deleteResults.filter(r => !r.success).forEach(r => {\n        console.log(`   - ${r.name}: ${r.error}`);\n      });\n    }\n    \n    return {\n      success: failCount === 0,\n      deleted_count: successCount,\n      failed_count: failCount,\n      protected_files: ['.gitkeep'],\n      results: deleteResults,\n      gitkeep_protected: true,\n      message: `âœ… ${successCount} dosya silindi, .gitkeep korundu`\n    };\n    \n  } catch (error) {\n    console.error('\\nâŒ KRÄ°TÄ°K HATA:', error.message);\n    return {\n      success: false,\n      error: error.message,\n      protected_files: ['.gitkeep'],\n      message: 'âŒ Silme iÅŸlemi baÅŸarÄ±sÄ±z'\n    };\n  }\n}\n\n// Ana fonksiyonu Ã§aÄŸÄ±r\nconst result = await deleteAllFilesExceptGitkeep();\n\n// Workflow'un devam edebilmesi iÃ§in orijinal veriyi de taÅŸÄ±\nreturn [{\n  json: {\n    ...$json,\n    github_cleanup: result,\n    cleanup_time: new Date().toISOString(),\n    cleanup_status: result.success ? 'temizlendi' : 'hata',\n    note: '.gitkeep dosyasÄ± korundu'\n  }\n}];"
  },
  "type": "n8n-nodes-base.code",
  "typeVersion": 2,
  "position": [192, 32],
  "id": "github-cleanup-code-node",
  "name": "ğŸ§¹ GitHub Temizlik (.gitkeep KalsÄ±n)"
}